on:
    push:
      branches: [ "main" ]
    pull_request:
      branches: [ "main" ]
    workflow_dispatch:
  
  jobs:
    build:
      runs-on: ubuntu-latest
  
      steps:
        - name: ğŸ“¥ Sjekker ut koden
          uses: actions/checkout@v4
  
        - name: ğŸ—ï¸ Setter opp Node.js
          uses: actions/setup-node@v4
          with:
            node-version: 18
            cache: 'npm'
  
        - name: ğŸ“¦ Installerer dependencies
          run: npm install
  
        - name: ğŸ—ï¸ Bygger prosjektet
          run: npm run build
  
        - name: âœ… KjÃ¸r tester
          run: npm test
  
        - name: ğŸ¨ Sjekker kodekvalitet med ESLint
          run: npm run lint
  
    deploy:
      needs: build
      runs-on: ubuntu-latest
  
      steps:
        - name: ğŸ“¥ Sjekker ut koden
          uses: actions/checkout@v4
  
        - name: ğŸš€ Installer Hydrogen CLI
          run: npm install -g @shopify/cli @shopify/hydrogen
  
        - name: ğŸ”‘ Logg inn i Shopify
          run: shopify login --store ${{ secrets.SHOPIFY_STORE }}
  
        - name: ğŸ“¤ Deploy til Shopify Hydrogen Hosting
          run: shopify hydrogen deploy --token=${{ secrets.SHOPIFY_DEPLOY_TOKEN }}
  